<!DOCTYPE html>
<html class="ui-page-login">

	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">

		<!--标准mui.css-->
		<link rel="stylesheet" href="../css/mui.min.css">
		<script type="text/javascript" src="../js/common.js" ></script>
		<!--App自定义的css-->
		<!-- <link rel="stylesheet" type="text/css" href="../css/app.css" /> -->
		<style>
			h5 {
				margin: 5px 7px;
			}
			#addsel{
				width: 115px;
			    position: absolute;
			    right: 0px;
			}
		</style>
	</head>

	<body>
		<header class="mui-bar mui-bar-nav">
			<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
			<h1 class="mui-title">紧急联系卡</h1>
		</header> 

			<div>
				<div>
					<input type="text" id="" />
					<span>姓名</span>
				 	<input type="text" id="name"/>
				</div>
				
				<div>
					<span>性别</span>
					<input type="text" id="sex" />
				</div>
					<div>
					<span>血型</span>
					<input type="text" id="bloodType" />
				</div>
				<div>
					<span>出生日期</span>
					<input type="date" id="birthday" value=""/>
				</div>
				
				<span>过敏史</span>
				<input type="text" id="allergyBill" />
				
				<span>既往病史</span>
				<input type="text" id="passIlls" />
				<span>紧急联系人</span>
				<input type="text" id="emergencyNum" />
				
				<div>
					<button type="button" class="mui-btn mui-btn-primary" onclick="saveInfoCardMsg();">保存</button>&nbsp;&nbsp;
				</div>
			</div>

	<script type="text/javascript" src="../js/jquery-2.1.0.js" ></script>
	<script type="text/javascript" src="../js/mui.min.js" ></script>
	<script type="text/javascript" src="../js/json.js" ></script>
	<script>
		var ip;
		$(function(){
			ip = getIP();
			showInfoCardMsg();
		});
		/**
		 * 展示个人信息卡信息
		 */
		function showInfoCardMsg(){
			var url = ip+"infoCard/showInfoCard.do";
			$.get(url,function(res){
				if(res.state==1){
					//回填
					console.log(res.data)
				$('#name').val(res.data[0].name);
				if(res.data[0].sex){
					$('#sex').val("男");
				}else{
					$('#sex').val("女");
				}				
			 	$('#bloodType').val(res.data[0].bloodType);
				$('#birthday').val(res.data[0].birthday);
				$('#allergyBill').val(res.data[0].allergyBill);
				$('#passIlls').val(res.data[0].passIlls);
				$('#emergencyNum').val(res.data[0].emergencyNum);
				}
			});
		}
		/**
		 * 更新保存紧急信息卡
		 */
		function saveInfoCardMsg(){
			var name = $('#name').val();
			var sex = $('#sex').val();
			var bloodType = $('#bloodType').val();
			var birthday = $('#birthday').val();
			var allergyBill = $('#allergyBill').val();
			var passIlls = $('#passIlls').val();
			var emergencyNum = $('#emergencyNum').val();
			var url = ip+"infoCard/saveInfoCard.do";
			var params = {
				name:name,
				sex:sex,
				bloodType:bloodType,
				birthday:birthday,
				allergyBill:allergyBill,
				passIlls:passIlls,
				emergencyNum:emergencyNum
			};
			$.post(url,params,function(res){
				if(res.state==1){
					alert("save ok")
				}
			});
		}
	</script>
	</body>

</html>